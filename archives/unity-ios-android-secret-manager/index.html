<!doctype html><html lang=ja dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>📔 Unity で iOS/Android アプリの設定値をセキュアに扱う方法 | Nikaeraintokyo.</title>
<meta name=keywords content="unity,ios,android"><meta name=description content="はじめに
iOS/Android でユーザーの情報をセキュアに扱う必要があったので、調査したところ Android には EncryptedSharedPreferences が存在することを知りました。iOS には Keychain Services が存在します。
今回は Unity の iOS/Android プラットフォーム上で設定値を保存するための実装を行う必要があったので、Unity から扱えるようネイティブプラグインを作成しました。今後もこういった要望はありそうでしたので、記事として手順や内容を書き記しておくことにしました。
本記事内で紹介しているコードは下記にアップ済みです。
https://github.com/nikaera/Unity-iOS-Android-SecretManager-Sample
動作環境

MacBook Air (M1, 2020)
Unity 2020.3.15f2
Android 6.0 以上

EncryptedSharedPreferences が使用可能なバージョン



Android のネイティブプラグインを作成する
Android 環境ではまず External Dependency Manager for Unity を利用して、Unity の Android ネイティブプラグインで EncryptedSharedPreferences 利用可能にします。
(追記) Gradle を利用したライブラリのインストール方法
shiena さんにご教授いただいたのですが、こちらの記事のように Gradle を利用することでも簡易にライブラリの取り込みが可能なようでした。
手順は上記の記事をご参照いただくとして、Gradle を利用する方法で外部ライブラリを取り込む際の Assets/Plugins/Android/mainTemplate.gradle および Assets/Plugins/Android/gradleTemplate.properties は下記になります。
dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar'])
+    implementation 'androidx.security:security-crypto:1.1.0-alpha03'
**DEPS**}

android {
org.gradle.jvmargs=-Xmx**JVM_HEAP_SIZE**M
org.gradle.parallel=true
android.enableR8=**MINIFY_WITH_R_EIGHT**
+ android.useAndroidX=true
unityStreamingAssets=.unity3d**STREAMING_ASSETS**
**ADDITIONAL_PROPERTIES**
Gradle を利用した方法でライブラリを利用される際は、次の External Dependency Manager for Unity で必要なパッケージをインストールする の手順はスキップ可能です。EncryptedSharedPreferences を利用するためのネイティブコードを追加する のステップから進めてください。"><meta name=author content="Me"><link rel=canonical href=https://zenn.dev/nikaera/articles/unity-ios-android-secret-manager><meta name=google-site-verification content="UA-33707296-2"><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=https://nikaera.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://nikaera.com/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://nikaera.com/favicon.ico><link rel=apple-touch-icon href=https://nikaera.com/apple-touch-icon.png><link rel=mask-icon href=https://nikaera.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=ja href=https://nikaera.com/archives/unity-ios-android-secret-manager/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="📔 Unity で iOS/Android アプリの設定値をセキュアに扱う方法"><meta property="og:description" content="はじめに
iOS/Android でユーザーの情報をセキュアに扱う必要があったので、調査したところ Android には EncryptedSharedPreferences が存在することを知りました。iOS には Keychain Services が存在します。
今回は Unity の iOS/Android プラットフォーム上で設定値を保存するための実装を行う必要があったので、Unity から扱えるようネイティブプラグインを作成しました。今後もこういった要望はありそうでしたので、記事として手順や内容を書き記しておくことにしました。
本記事内で紹介しているコードは下記にアップ済みです。
https://github.com/nikaera/Unity-iOS-Android-SecretManager-Sample
動作環境

MacBook Air (M1, 2020)
Unity 2020.3.15f2
Android 6.0 以上

EncryptedSharedPreferences が使用可能なバージョン



Android のネイティブプラグインを作成する
Android 環境ではまず External Dependency Manager for Unity を利用して、Unity の Android ネイティブプラグインで EncryptedSharedPreferences 利用可能にします。
(追記) Gradle を利用したライブラリのインストール方法
shiena さんにご教授いただいたのですが、こちらの記事のように Gradle を利用することでも簡易にライブラリの取り込みが可能なようでした。
手順は上記の記事をご参照いただくとして、Gradle を利用する方法で外部ライブラリを取り込む際の Assets/Plugins/Android/mainTemplate.gradle および Assets/Plugins/Android/gradleTemplate.properties は下記になります。
dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar'])
+    implementation 'androidx.security:security-crypto:1.1.0-alpha03'
**DEPS**}

android {
org.gradle.jvmargs=-Xmx**JVM_HEAP_SIZE**M
org.gradle.parallel=true
android.enableR8=**MINIFY_WITH_R_EIGHT**
+ android.useAndroidX=true
unityStreamingAssets=.unity3d**STREAMING_ASSETS**
**ADDITIONAL_PROPERTIES**
Gradle を利用した方法でライブラリを利用される際は、次の External Dependency Manager for Unity で必要なパッケージをインストールする の手順はスキップ可能です。EncryptedSharedPreferences を利用するためのネイティブコードを追加する のステップから進めてください。"><meta property="og:type" content="article"><meta property="og:url" content="https://nikaera.com/archives/unity-ios-android-secret-manager/"><meta property="og:image" content="https://i.gyazo.com/b481751ed990606d15263c84568b1e05.png"><meta property="article:section" content="archives"><meta property="article:published_time" content="2021-08-15T00:00:00+00:00"><meta property="article:modified_time" content="2021-08-15T00:00:00+00:00"><meta property="og:site_name" content="Nikaeraintokyo."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://i.gyazo.com/b481751ed990606d15263c84568b1e05.png"><meta name=twitter:title content="📔 Unity で iOS/Android アプリの設定値をセキュアに扱う方法"><meta name=twitter:description content="はじめに
iOS/Android でユーザーの情報をセキュアに扱う必要があったので、調査したところ Android には EncryptedSharedPreferences が存在することを知りました。iOS には Keychain Services が存在します。
今回は Unity の iOS/Android プラットフォーム上で設定値を保存するための実装を行う必要があったので、Unity から扱えるようネイティブプラグインを作成しました。今後もこういった要望はありそうでしたので、記事として手順や内容を書き記しておくことにしました。
本記事内で紹介しているコードは下記にアップ済みです。
https://github.com/nikaera/Unity-iOS-Android-SecretManager-Sample
動作環境

MacBook Air (M1, 2020)
Unity 2020.3.15f2
Android 6.0 以上

EncryptedSharedPreferences が使用可能なバージョン



Android のネイティブプラグインを作成する
Android 環境ではまず External Dependency Manager for Unity を利用して、Unity の Android ネイティブプラグインで EncryptedSharedPreferences 利用可能にします。
(追記) Gradle を利用したライブラリのインストール方法
shiena さんにご教授いただいたのですが、こちらの記事のように Gradle を利用することでも簡易にライブラリの取り込みが可能なようでした。
手順は上記の記事をご参照いただくとして、Gradle を利用する方法で外部ライブラリを取り込む際の Assets/Plugins/Android/mainTemplate.gradle および Assets/Plugins/Android/gradleTemplate.properties は下記になります。
dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar'])
+    implementation 'androidx.security:security-crypto:1.1.0-alpha03'
**DEPS**}

android {
org.gradle.jvmargs=-Xmx**JVM_HEAP_SIZE**M
org.gradle.parallel=true
android.enableR8=**MINIFY_WITH_R_EIGHT**
+ android.useAndroidX=true
unityStreamingAssets=.unity3d**STREAMING_ASSETS**
**ADDITIONAL_PROPERTIES**
Gradle を利用した方法でライブラリを利用される際は、次の External Dependency Manager for Unity で必要なパッケージをインストールする の手順はスキップ可能です。EncryptedSharedPreferences を利用するためのネイティブコードを追加する のステップから進めてください。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Archives","item":"https://nikaera.com/archives/"},{"@type":"ListItem","position":2,"name":"📔 Unity で iOS/Android アプリの設定値をセキュアに扱う方法","item":"https://nikaera.com/archives/unity-ios-android-secret-manager/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"📔 Unity で iOS/Android アプリの設定値をセキュアに扱う方法","name":"📔 Unity で iOS\/Android アプリの設定値をセキュアに扱う方法","description":"はじめに iOS/Android でユーザーの情報をセキュアに扱う必要があったので、調査したところ Android には EncryptedSharedPreferences が存在することを知りました。iOS には Keychain Services が存在します。\n今回は Unity の iOS/Android プラットフォーム上で設定値を保存するための実装を行う必要があったので、Unity から扱えるようネイティブプラグインを作成しました。今後もこういった要望はありそうでしたので、記事として手順や内容を書き記しておくことにしました。\n本記事内で紹介しているコードは下記にアップ済みです。\nhttps://github.com/nikaera/Unity-iOS-Android-SecretManager-Sample\n動作環境 MacBook Air (M1, 2020) Unity 2020.3.15f2 Android 6.0 以上 EncryptedSharedPreferences が使用可能なバージョン Android のネイティブプラグインを作成する Android 環境ではまず External Dependency Manager for Unity を利用して、Unity の Android ネイティブプラグインで EncryptedSharedPreferences 利用可能にします。\n(追記) Gradle を利用したライブラリのインストール方法 shiena さんにご教授いただいたのですが、こちらの記事のように Gradle を利用することでも簡易にライブラリの取り込みが可能なようでした。\n手順は上記の記事をご参照いただくとして、Gradle を利用する方法で外部ライブラリを取り込む際の Assets/Plugins/Android/mainTemplate.gradle および Assets/Plugins/Android/gradleTemplate.properties は下記になります。\ndependencies { implementation fileTree(dir: \u0026#39;libs\u0026#39;, include: [\u0026#39;*.jar\u0026#39;]) + implementation \u0026#39;androidx.security:security-crypto:1.1.0-alpha03\u0026#39; **DEPS**} android { org.gradle.jvmargs=-Xmx**JVM_HEAP_SIZE**M org.gradle.parallel=true android.enableR8=**MINIFY_WITH_R_EIGHT** + android.useAndroidX=true unityStreamingAssets=.unity3d**STREAMING_ASSETS** **ADDITIONAL_PROPERTIES** Gradle を利用した方法でライブラリを利用される際は、次の External Dependency Manager for Unity で必要なパッケージをインストールする の手順はスキップ可能です。EncryptedSharedPreferences を利用するためのネイティブコードを追加する のステップから進めてください。\n","keywords":["unity","ios","android"],"articleBody":"はじめに iOS/Android でユーザーの情報をセキュアに扱う必要があったので、調査したところ Android には EncryptedSharedPreferences が存在することを知りました。iOS には Keychain Services が存在します。\n今回は Unity の iOS/Android プラットフォーム上で設定値を保存するための実装を行う必要があったので、Unity から扱えるようネイティブプラグインを作成しました。今後もこういった要望はありそうでしたので、記事として手順や内容を書き記しておくことにしました。\n本記事内で紹介しているコードは下記にアップ済みです。\nhttps://github.com/nikaera/Unity-iOS-Android-SecretManager-Sample\n動作環境 MacBook Air (M1, 2020) Unity 2020.3.15f2 Android 6.0 以上 EncryptedSharedPreferences が使用可能なバージョン Android のネイティブプラグインを作成する Android 環境ではまず External Dependency Manager for Unity を利用して、Unity の Android ネイティブプラグインで EncryptedSharedPreferences 利用可能にします。\n(追記) Gradle を利用したライブラリのインストール方法 shiena さんにご教授いただいたのですが、こちらの記事のように Gradle を利用することでも簡易にライブラリの取り込みが可能なようでした。\n手順は上記の記事をご参照いただくとして、Gradle を利用する方法で外部ライブラリを取り込む際の Assets/Plugins/Android/mainTemplate.gradle および Assets/Plugins/Android/gradleTemplate.properties は下記になります。\ndependencies { implementation fileTree(dir: 'libs', include: ['*.jar']) + implementation 'androidx.security:security-crypto:1.1.0-alpha03' **DEPS**} android { org.gradle.jvmargs=-Xmx**JVM_HEAP_SIZE**M org.gradle.parallel=true android.enableR8=**MINIFY_WITH_R_EIGHT** + android.useAndroidX=true unityStreamingAssets=.unity3d**STREAMING_ASSETS** **ADDITIONAL_PROPERTIES** Gradle を利用した方法でライブラリを利用される際は、次の External Dependency Manager for Unity で必要なパッケージをインストールする の手順はスキップ可能です。EncryptedSharedPreferences を利用するためのネイティブコードを追加する のステップから進めてください。\nExternal Dependency Manager for Unity を利用する方法だと、取り込み先プロジェクト内でライブラリの競合が発生する恐れがあります。Gradle を利用する方法であれば回避が可能です。1\nExternal Dependency Manager for Unity で必要なパッケージをインストールする External Dependency Manager for Unity をインポートするため unitypackage をダウンロードして、EncryptedSharedPreferences を導入したい Unity プロジェクトを開いてから unitypackage をクリックすることで、External Dependency Manager for Unity を Unity プロジェクトにインポートします。\nUnity プロジェクトの Build Settings からプラットフォームは Android に切り替えておきます。Enable Android Auto-resolution? というダイアログの選択肢はどちらを選んでも構いません。2\nExternal Dependency Manager for Unity で各種パッケージを管理する方法は README に記載がある通り、*Dependencies.xml というファイルを Editor フォルダに配置することで可能になります。\n今回は EncryptedSharedPreferences を導入するため、下記の xml ファイルを Editor フォルダ内に配置します。\n\u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e ","wordCount":"1439","inLanguage":"ja","image":"https://i.gyazo.com/b481751ed990606d15263c84568b1e05.png","datePublished":"2021-08-15T00:00:00Z","dateModified":"2021-08-15T00:00:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://nikaera.com/archives/unity-ios-android-secret-manager/"},"publisher":{"@type":"Organization","name":"Nikaeraintokyo.","logo":{"@type":"ImageObject","url":"https://nikaera.com/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://nikaera.com/ accesskey=h title="Nikaeraintokyo. (Alt + H)">Nikaeraintokyo.</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></span></div><ul id=menu><li><a href=https://nikaera.tumblr.com/ title="Music 🎵" target=_blank rel="noopener noreferrer"><span>Music 🎵</span></a></li><li><span>|</span></li><li><a href=https://nikaera.com/archives/ title="Archives 🗄️"><span>Archives 🗄️</span></a></li><li><a href=https://nikaera.com/rss_feeds/ title="RSS Feeds 🔖"><span>RSS Feeds 🔖</span></a></li><li><a href=https://nikaera.com/profile/ title="Profile 👦"><span>Profile 👦</span></a></li><li><a href=https://nikaera.com/portfolio/ title="Portfolio 💼"><span>Portfolio 💼</span></a></li><li><a href=https://nikaera.com/contact/ title="Contact 📥"><span>Contact 📥</span></a></li><li><a href=https://nikaera.com/search/ title="Search 🔍"><span>Search 🔍</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>📔 Unity で iOS/Android アプリの設定値をセキュアに扱う方法</h1><div class=post-meta><span title='2021-08-15 00:00:00 +0000 UTC'>8月 15, 2021</span>&nbsp;·&nbsp;7 分&nbsp;·&nbsp;Me
<span style=text-align:right;margin-left:auto;font-size:1em>Originally published at <a href=https://zenn.dev/nikaera/articles/unity-ios-android-secret-manager target=_blank rel="noopener noreferrer">zenn.dev</a></span></div></header><figure class=entry-cover><img loading=lazy src=https://i.gyazo.com/b481751ed990606d15263c84568b1e05.png alt="本記事内の Unity サンプルプロジェクトを起動した際のスクショ"></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目次</span></summary><div class=inner><ul><li><a href=#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab aria-label=はじめに>はじめに</a></li><li><a href=#%e5%8b%95%e4%bd%9c%e7%92%b0%e5%a2%83 aria-label=動作環境>動作環境</a></li><li><a href=#android-%e3%81%ae%e3%83%8d%e3%82%a4%e3%83%86%e3%82%a3%e3%83%96%e3%83%97%e3%83%a9%e3%82%b0%e3%82%a4%e3%83%b3%e3%82%92%e4%bd%9c%e6%88%90%e3%81%99%e3%82%8b aria-label="Android のネイティブプラグインを作成する">Android のネイティブプラグインを作成する</a><ul><li><a href=#%e8%bf%bd%e8%a8%98-gradle-%e3%82%92%e5%88%a9%e7%94%a8%e3%81%97%e3%81%9f%e3%83%a9%e3%82%a4%e3%83%96%e3%83%a9%e3%83%aa%e3%81%ae%e3%82%a4%e3%83%b3%e3%82%b9%e3%83%88%e3%83%bc%e3%83%ab%e6%96%b9%e6%b3%95 aria-label="(追記) Gradle を利用したライブラリのインストール方法">(追記) Gradle を利用したライブラリのインストール方法</a></li><li><a href=#external-dependency-manager-for-unity-%e3%81%a7%e5%bf%85%e8%a6%81%e3%81%aa%e3%83%91%e3%83%83%e3%82%b1%e3%83%bc%e3%82%b8%e3%82%92%e3%82%a4%e3%83%b3%e3%82%b9%e3%83%88%e3%83%bc%e3%83%ab%e3%81%99%e3%82%8b aria-label="External Dependency Manager for Unity で必要なパッケージをインストールする">External Dependency Manager for Unity で必要なパッケージをインストールする</a></li><li><a href=#encryptedsharedpreferences-%e3%82%92%e5%88%a9%e7%94%a8%e3%81%99%e3%82%8b%e3%81%9f%e3%82%81%e3%81%ae%e3%83%8d%e3%82%a4%e3%83%86%e3%82%a3%e3%83%96%e3%82%b3%e3%83%bc%e3%83%89%e3%82%92%e8%bf%bd%e5%8a%a0%e3%81%99%e3%82%8b aria-label="EncryptedSharedPreferences を利用するためのネイティブコードを追加する">EncryptedSharedPreferences を利用するためのネイティブコードを追加する</a></li></ul></li><li><a href=#ios-%e3%81%ae%e3%83%8d%e3%82%a4%e3%83%86%e3%82%a3%e3%83%96%e3%83%97%e3%83%a9%e3%82%b0%e3%82%a4%e3%83%b3%e3%82%92%e4%bd%9c%e6%88%90%e3%81%99%e3%82%8b aria-label="iOS のネイティブプラグインを作成する">iOS のネイティブプラグインを作成する</a><ul><li><a href=#keychain-services-%e3%82%92%e5%88%a9%e7%94%a8%e3%81%99%e3%82%8b%e3%81%9f%e3%82%81%e3%81%ae%e3%83%8d%e3%82%a4%e3%83%86%e3%82%a3%e3%83%96%e3%82%b3%e3%83%bc%e3%83%89%e3%82%92%e8%bf%bd%e5%8a%a0%e3%81%99%e3%82%8b aria-label="Keychain Services を利用するためのネイティブコードを追加する">Keychain Services を利用するためのネイティブコードを追加する</a></li></ul></li><li><a href=#%e4%bd%99%e8%ab%87-%e3%82%a4%e3%83%b3%e3%82%bf%e3%83%bc%e3%83%95%e3%82%a7%e3%83%bc%e3%82%b9%e3%81%a7-iosandroid-%e3%81%ae%e3%81%b5%e3%82%8b%e3%81%be%e3%81%84%e3%82%92%e5%85%b1%e9%80%9a%e5%8c%96%e3%81%99%e3%82%8b aria-label="(余談) インターフェースで iOS/Android のふるまいを共通化する">(余談) インターフェースで iOS/Android のふるまいを共通化する</a></li><li><a href=#%e3%81%8a%e3%82%8f%e3%82%8a%e3%81%ab aria-label=おわりに>おわりに</a></li><li><a href=#%e5%8f%82%e8%80%83%e3%83%aa%e3%83%b3%e3%82%af aria-label=参考リンク>参考リンク</a></li></ul></div></details></div><div class=post-content><h1 id=はじめに>はじめに<a hidden class=anchor aria-hidden=true href=#はじめに>#</a></h1><p>iOS/Android でユーザーの情報をセキュアに扱う必要があったので、調査したところ Android には <a href=https://developer.android.com/reference/androidx/security/crypto/EncryptedSharedPreferences>EncryptedSharedPreferences</a> が存在することを知りました。iOS には <a href=https://developer.apple.com/documentation/security/keychain_services>Keychain Services</a> が存在します。</p><p>今回は Unity の iOS/Android プラットフォーム上で設定値を保存するための実装を行う必要があったので、Unity から扱えるようネイティブプラグインを作成しました。今後もこういった要望はありそうでしたので、記事として手順や内容を書き記しておくことにしました。</p><p>本記事内で紹介しているコードは下記にアップ済みです。</p><p><a href=https://github.com/nikaera/Unity-iOS-Android-SecretManager-Sample>https://github.com/nikaera/Unity-iOS-Android-SecretManager-Sample</a></p><h1 id=動作環境>動作環境<a hidden class=anchor aria-hidden=true href=#動作環境>#</a></h1><ul><li>MacBook Air (M1, 2020)</li><li>Unity 2020.3.15f2</li><li>Android 6.0 以上<ul><li><a href=https://developer.android.com/reference/androidx/security/crypto/EncryptedSharedPreferences>EncryptedSharedPreferences</a> が使用可能なバージョン</li></ul></li></ul><h1 id=android-のネイティブプラグインを作成する>Android のネイティブプラグインを作成する<a hidden class=anchor aria-hidden=true href=#android-のネイティブプラグインを作成する>#</a></h1><p>Android 環境ではまず <a href=https://github.com/googlesamples/unity-jar-resolver>External Dependency Manager for Unity</a> を利用して、Unity の Android ネイティブプラグインで <code>EncryptedSharedPreferences</code> 利用可能にします。</p><h2 id=追記-gradle-を利用したライブラリのインストール方法>(追記) Gradle を利用したライブラリのインストール方法<a hidden class=anchor aria-hidden=true href=#追記-gradle-を利用したライブラリのインストール方法>#</a></h2><p><a href=https://twitter.com/shiena>shiena</a> さんにご教授いただいたのですが、<a href=https://zenn.dev/shiena/articles/unity-sqlcipher#gradle%E3%82%92%E5%88%A9%E7%94%A8>こちらの記事</a>のように Gradle を利用することでも簡易にライブラリの取り込みが可能なようでした。</p><p>手順は上記の記事をご参照いただくとして、Gradle を利用する方法で外部ライブラリを取り込む際の <code>Assets/Plugins/Android/mainTemplate.gradle</code> および <code>Assets/Plugins/Android/gradleTemplate.properties</code> は下記になります。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>dependencies {
</span></span><span style=display:flex><span>    implementation fileTree(dir: &#39;libs&#39;, include: [&#39;*.jar&#39;])
</span></span><span style=display:flex><span><span style=color:#a6e22e>+    implementation &#39;androidx.security:security-crypto:1.1.0-alpha03&#39;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>**DEPS**}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>android {
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>org.gradle.jvmargs=-Xmx**JVM_HEAP_SIZE**M
</span></span><span style=display:flex><span>org.gradle.parallel=true
</span></span><span style=display:flex><span>android.enableR8=**MINIFY_WITH_R_EIGHT**
</span></span><span style=display:flex><span><span style=color:#a6e22e>+ android.useAndroidX=true
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>unityStreamingAssets=.unity3d**STREAMING_ASSETS**
</span></span><span style=display:flex><span>**ADDITIONAL_PROPERTIES**
</span></span></code></pre></div><p><strong>Gradle を利用した方法でライブラリを利用される際は、次の <code>External Dependency Manager for Unity で必要なパッケージをインストールする</code> の手順はスキップ可能です。<code>EncryptedSharedPreferences を利用するためのネイティブコードを追加する</code> のステップから進めてください。</strong></p><p><code>External Dependency Manager for Unity</code> を利用する方法だと、取り込み先プロジェクト内でライブラリの競合が発生する恐れがあります。Gradle を利用する方法であれば回避が可能です。<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h2 id=external-dependency-manager-for-unity-で必要なパッケージをインストールする>External Dependency Manager for Unity で必要なパッケージをインストールする<a hidden class=anchor aria-hidden=true href=#external-dependency-manager-for-unity-で必要なパッケージをインストールする>#</a></h2><p><code>External Dependency Manager for Unity</code> をインポートするため <a href=https://github.com/googlesamples/unity-jar-resolver/blob/master/external-dependency-manager-latest.unitypackage>unitypackage</a> をダウンロードして、<strong><code>EncryptedSharedPreferences</code> を導入したい Unity プロジェクトを開いてから <code>unitypackage</code> をクリックすることで、<code>External Dependency Manager for Unity</code> を Unity プロジェクトにインポートします。</strong></p><p><img loading=lazy src=https://i.gyazo.com/1af7cdf4d7d5749e59e151eef1ca5493.png alt="ダウンロードした unitypackage をクリックして Unity プロジェクトに External Dependency Manager for Unity をインポートする"></p><p>Unity プロジェクトの <code>Build Settings</code> からプラットフォームは Android に切り替えておきます。<code>Enable Android Auto-resolution?</code> というダイアログの選択肢はどちらを選んでも構いません。<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><p>External Dependency Manager for Unity で各種パッケージを管理する方法は <a href=https://github.com/googlesamples/unity-jar-resolver#android-resolver-usage>README</a> に記載がある通り、<strong><code>*Dependencies.xml</code> というファイルを <code>Editor</code> フォルダに配置することで可能になります。</strong></p><p>今回は <code>EncryptedSharedPreferences</code> を導入するため、下記の xml ファイルを <code>Editor</code> フォルダ内に配置します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml:Assets/Editor/AndroidPluginDependencies.xml data-lang=xml:Assets/Editor/AndroidPluginDependencies.xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;dependencies&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;androidPackages&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#75715e>            本記事ではバージョン 1.1.0-alpha03 を利用している
</span></span></span><span style=display:flex><span><span style=color:#75715e>        --&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;androidPackage</span> <span style=color:#a6e22e>spec=</span><span style=color:#e6db74>&#34;androidx.security:security-crypto:1.1.0-alpha03&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;androidSdkPackageIds&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#75715e>                    Google の Maven リポジトリからインストールするため、
</span></span></span><span style=display:flex><span><span style=color:#75715e>                    extra-google-m2repository を指定する
</span></span></span><span style=display:flex><span><span style=color:#75715e>                --&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;androidSdkPackageId&gt;</span>extra-google-m2repository<span style=color:#f92672>&lt;/androidSdkPackageId&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/androidSdkPackageIds&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/androidPackage&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/androidPackages&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/dependencies&gt;</span>
</span></span></code></pre></div><p>その後、<strong>Unity メニューから <code>Assets -> External Dependency Manager -> Android Resolver -> Force Resolve</code> を選択して、<code>Assets/Editor/AndroidPluginDependencies.xml</code> の内容を元に <code>EncryptedSharedPreferences</code> を利用するのに必要なパッケージを自動で <code>Assets/Plugins/Android</code> フォルダにダウンロードします。</strong></p><p><img loading=lazy src=https://i.gyazo.com/df394e15149e54dae3e9a81848512ee9.png alt="1. Unity メニューから Assets -> External Dependency Manager -> Android Resolver -> Force Resolve を選択する">
<strong>1. Unity メニューから <code>Assets -> External Dependency Manager -> Android Resolver -> Force Resolve</code> を選択する</strong></p><p><img loading=lazy src=https://i.gyazo.com/f6d2ec95ef9c2afdc857fecef2b165e5.png alt="2. 実行に成功すると EncryptedSharedPreferences を利用するのに必要なライブラリ群が Assets/Plugins/Android フォルダに配置される">
<strong>2. 実行に成功すると EncryptedSharedPreferences を利用するのに必要なライブラリ群が <code>Assets/Plugins/Android</code> フォルダに配置される</strong></p><p>ここまで来ればあとは Android ネイティブコードを <code>Assets/Plugins/Android</code> フォルダ内に配置して Unity 側から叩けるようにするだけです。</p><h2 id=encryptedsharedpreferences-を利用するためのネイティブコードを追加する>EncryptedSharedPreferences を利用するためのネイティブコードを追加する<a hidden class=anchor aria-hidden=true href=#encryptedsharedpreferences-を利用するためのネイティブコードを追加する>#</a></h2><p>早速下記の Android ネイティブコードを <code>Assets/Plugins/Android/SecretManager.java</code> に配置します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java:Assets/Plugins/Android/SecretManager.java data-lang=java:Assets/Plugins/Android/SecretManager.java><span style=display:flex><span><span style=color:#f92672>package</span> com.nikaera;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.unity3d.player.UnityPlayerActivity;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.lang.Exception;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// External Dependency Manager for Unity によって、</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 必要な jar が含まれているため EncryptedSharedPreferences の利用が可能になる</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> androidx.security.crypto.EncryptedSharedPreferences;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> androidx.security.crypto.MasterKey;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> android.content.Context;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> android.content.SharedPreferences;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> android.content.SharedPreferences.Editor;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> android.os.Bundle;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> android.util.Log;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecretManager</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> SharedPreferences sharedPreferences;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>SecretManager</span>(Context context) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// EncryptedSharedPreferences で設定値を保存する際に用いる、</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 暗号鍵を扱うためのラッパークラスをデフォルト設定で作成する</span>
</span></span><span style=display:flex><span>        MasterKey masterKey <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> MasterKey.<span style=color:#a6e22e>Builder</span>(context)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>setKeyScheme</span>(MasterKey.<span style=color:#a6e22e>KeyScheme</span>.<span style=color:#a6e22e>AES256_GCM</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>build</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// EncryptedSharedPreferences のインスタンスを生成する</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// コンストラクタで作成した masterKey を指定している</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>sharedPreferences</span> <span style=color:#f92672>=</span> EncryptedSharedPreferences.<span style=color:#a6e22e>create</span>(
</span></span><span style=display:flex><span>          context, context.<span style=color:#a6e22e>getPackageName</span>(), masterKey,
</span></span><span style=display:flex><span>          EncryptedSharedPreferences.<span style=color:#a6e22e>PrefKeyEncryptionScheme</span>.<span style=color:#a6e22e>AES256_SIV</span>,
</span></span><span style=display:flex><span>          EncryptedSharedPreferences.<span style=color:#a6e22e>PrefValueEncryptionScheme</span>.<span style=color:#a6e22e>AES256_GCM</span>
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (Exception e) {
</span></span><span style=display:flex><span>        e.<span style=color:#a6e22e>printStackTrace</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * 指定したキーで値を保存する関数
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * @param key 値を保存する際に用いるキー
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * @param value 保存したい値
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * @return boolean 値の保存に成功したかどうか
</span></span></span><span style=display:flex><span><span style=color:#75715e>   */</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>put</span>(String key, String value) {
</span></span><span style=display:flex><span>    SharedPreferences.<span style=color:#a6e22e>Editor</span> editor <span style=color:#f92672>=</span> sharedPreferences.<span style=color:#a6e22e>edit</span>();
</span></span><span style=display:flex><span>    editor.<span style=color:#a6e22e>putString</span>(key, value);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> editor.<span style=color:#a6e22e>commit</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * 指定したキーで保存した値を取得する関数
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * `put` 関数で保存した値を取得するのに利用する
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * @param key 取得したい値のキー
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * @return string キーに紐づく値、存在しなければ空文字が返却される
</span></span></span><span style=display:flex><span><span style=color:#75715e>   */</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>get</span>(String key) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sharedPreferences.<span style=color:#a6e22e>getString</span>(key, <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * 指定したキーで値を削除する関数
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * @param key 削除したい値のキー
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * @return boolean 値の削除に成功したかどうか
</span></span></span><span style=display:flex><span><span style=color:#75715e>   */</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>delete</span>(String key) {
</span></span><span style=display:flex><span>    SharedPreferences.<span style=color:#a6e22e>Editor</span> editor <span style=color:#f92672>=</span> sharedPreferences.<span style=color:#a6e22e>edit</span>();
</span></span><span style=display:flex><span>    editor.<span style=color:#a6e22e>remove</span>(key);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> editor.<span style=color:#a6e22e>commit</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>その後、上記を Unity スクリプトから実行可能にするための C# クラスを作成します。本記事ではファイルを <code>Assets/Scripts/EncryptedSharedPreferences.cs</code> に配置します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp:Assets/Scripts/EncryptedSharedPreferences.cs data-lang=csharp:Assets/Scripts/EncryptedSharedPreferences.cs><span style=display:flex><span><span style=color:#66d9ef>using</span> UnityEngine;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>///     利用するネイティブコードは &lt;c&gt;Assets/Plugins/Android/SecretManager.java&lt;/c&gt; に記載</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>///     &lt;a href=&#34;https://developer.android.com/reference/androidx/security/crypto/EncryptedSharedPreferences&#34;&gt;EncryptedSharedPreferences&lt;/a&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>EncryptedSharedPreferences</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> AndroidJavaObject _secretManager;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> EncryptedSharedPreferences()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// コンストラクタで com.nikaera.SecretManager のインスタンス生成を行う</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> activity = <span style=color:#66d9ef>new</span> AndroidJavaClass(<span style=color:#e6db74>&#34;com.unity3d.player.UnityPlayer&#34;</span>)
</span></span><span style=display:flex><span>            .GetStatic&lt;AndroidJavaObject&gt;(<span style=color:#e6db74>&#34;currentActivity&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> context = activity.Call&lt;AndroidJavaObject&gt;(<span style=color:#e6db74>&#34;getApplicationContext&#34;</span>);
</span></span><span style=display:flex><span>        _secretManager = <span style=color:#66d9ef>new</span> AndroidJavaObject(<span style=color:#e6db74>&#34;com.nikaera.SecretManager&#34;</span>, context);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> Put(<span style=color:#66d9ef>string</span> key, <span style=color:#66d9ef>string</span> <span style=color:#66d9ef>value</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> _secretManager.Call&lt;<span style=color:#66d9ef>bool</span>&gt;(<span style=color:#e6db74>&#34;put&#34;</span>, key, <span style=color:#66d9ef>value</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Get(<span style=color:#66d9ef>string</span> key)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> _secretManager.Call&lt;<span style=color:#66d9ef>string</span>&gt;(<span style=color:#e6db74>&#34;get&#34;</span>, key);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> Delete(<span style=color:#66d9ef>string</span> key)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> _secretManager.Call&lt;<span style=color:#66d9ef>bool</span>&gt;(<span style=color:#e6db74>&#34;delete&#34;</span>, key);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>あとは用途に応じて下記のようなコードで設定値の保存や取得などを行えます。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// ...</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> _sharedPreferences = <span style=color:#66d9ef>new</span> EncryptedSharedPreferences();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// name をキーとして値を nikaera で保存する</span>
</span></span><span style=display:flex><span>_sharedPreferences.Put(<span style=color:#e6db74>&#34;name&#34;</span>, <span style=color:#e6db74>&#34;nikaera&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// name をキーとして値を取得する</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> name = _sharedPreferences.Get(<span style=color:#e6db74>&#34;name&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// &#34;nikaera&#34; が出力される</span>
</span></span><span style=display:flex><span>Debug.Log(name);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//　name をキーとして値を削除する</span>
</span></span><span style=display:flex><span>_sharedPreferences.Delete(<span style=color:#e6db74>&#34;name&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ...</span>
</span></span></code></pre></div><h1 id=ios-のネイティブプラグインを作成する>iOS のネイティブプラグインを作成する<a hidden class=anchor aria-hidden=true href=#ios-のネイティブプラグインを作成する>#</a></h1><p>iOS の場合は外部ライブラリを利用しないため、<code>External Dependency Manager for Unity</code> は利用しません。<strong>本来であれば Swift で信頼できる外部フレームワークを取り込み利用できると良さそうですが、今回は Objective-C でネイティブプラグインを書いていきます。</strong><sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></p><h2 id=keychain-services-を利用するためのネイティブコードを追加する>Keychain Services を利用するためのネイティブコードを追加する<a hidden class=anchor aria-hidden=true href=#keychain-services-を利用するためのネイティブコードを追加する>#</a></h2><p>早速下記の iOS ネイティブコードを <code>Assets/Plugins/iOS/KeychainService.mm</code> に配置します。</p><pre tabindex=0><code class=language-objc:Assets/Plugins/iOS/KeychainService.mm data-lang=objc:Assets/Plugins/iOS/KeychainService.mm>// Keychain Services を利用するために Security フレームワークを利用する
#import &lt;Security/Security.h&gt;

extern &#34;C&#34;
{
    // 指定したキーで値を保存する関数
    // - param
    //   - dataType:  値を保存する際に用いるキー
    //   - value: 保存したい値
    // - return
    //   - 保存時のステータスコードを返却する (0 以外は失敗)
    int addItem(const char *dataType, const char *value)
    {
        NSMutableDictionary* attributes = nil;
        NSMutableDictionary* query = [NSMutableDictionary dictionary];
        NSData* sata = [[NSString stringWithCString:value encoding:NSUTF8StringEncoding] dataUsingEncoding:NSUTF8StringEncoding];

        [query setObject:(id)kSecClassGenericPassword forKey:(id)kSecClass];
        [query setObject:(id)[NSString stringWithCString:dataType encoding:NSUTF8StringEncoding] forKey:(id)kSecAttrAccount];

        OSStatus err = SecItemCopyMatching((CFDictionaryRef)query, NULL);

        if (err == noErr) {
            attributes = [NSMutableDictionary dictionary];
            [attributes setObject:sata forKey:(id)kSecValueData];
            [attributes setObject:[NSDate date] forKey:(id)kSecAttrModificationDate];

            err = SecItemUpdate((CFDictionaryRef)query, (CFDictionaryRef)attributes);
            return (int)err;
        } else if (err == errSecItemNotFound) {
            attributes = [NSMutableDictionary dictionary];
            [attributes setObject:(id)kSecClassGenericPassword forKey:(id)kSecClass];
            [attributes setObject:(id)[NSString stringWithCString:dataType encoding:NSUTF8StringEncoding] forKey:(id)kSecAttrAccount];
            [attributes setObject:sata forKey:(id)kSecValueData];
            [attributes setObject:[NSDate date] forKey:(id)kSecAttrCreationDate];
            [attributes setObject:[NSDate date] forKey:(id)kSecAttrModificationDate];
            err = SecItemAdd((CFDictionaryRef)attributes, NULL);
            return (int)err;
        } else {
            return (int)err;
        }
    }

    // 指定したキーで値を取得する関数
    // - param
    //   - dataType: 値を取得する際に用いるキー
    // - return
    //   - キーに紐づく値、存在しなければ空文字が返却される
    char* getItem(const char *dataType)
    {
        NSMutableDictionary* query = [NSMutableDictionary dictionary];
        [query setObject:(id)kSecClassGenericPassword forKey:(id)kSecClass];
        [query setObject:(id)[NSString stringWithCString:dataType encoding:NSUTF8StringEncoding] forKey:(id)kSecAttrAccount];
        [query setObject:(id)kCFBooleanTrue forKey:(id)kSecReturnData];

        CFDataRef cfresult = NULL;
        OSStatus err = SecItemCopyMatching((CFDictionaryRef)query, (CFTypeRef*)&amp;cfresult);

        if (err == noErr) {
            NSData* passwordData = (__bridge_transfer NSData *)cfresult;
            const char* value = [[[NSString alloc] initWithData:passwordData encoding:NSUTF8StringEncoding] UTF8String];
            char *str = strdup(value);
            return str;
        } else {
            return NULL;
        }
    }

    // 指定したキーで値を削除する関数
    // - param
    //   - dataType:  値を削除する際に用いるキー
    // - return
    //   - 保存時のステータスコードを返却する (0 以外は失敗)
    int deleteItem(const char *dataType)
    {
        NSMutableDictionary* query = [NSMutableDictionary dictionary];
        [query setObject:(id)kSecClassGenericPassword forKey:(id)kSecClass];
        [query setObject:(id)[NSString stringWithCString:dataType encoding:NSUTF8StringEncoding] forKey:(id)kSecAttrAccount];

        OSStatus err = SecItemDelete((CFDictionaryRef)query);

        if (err == noErr) {
            return 0;
        } else {
            return (int)err;
        }
    }
}
</code></pre><p><code>Keychain Services</code> は <code>Security</code> フレームワークを利用するため、<strong><code>KeychainService.mm</code> に対して <code>Security</code> フレームワークの依存関係を設定する必要があります。</strong></p><p><img loading=lazy src=https://i.gyazo.com/ba82aaced24b83b37bf8c63e1ee7142f.png alt="KeychainService.mm で Security フレームワークの利用を可能にする">
<strong><code>KeychainService.mm</code> で <code>Security</code> フレームワークの利用を可能にする</strong></p><p>その後、上記を Unity スクリプトから実行可能にするための C# クラスを作成します。本記事ではファイルを <code>Assets/Scripts/KeychainService.cs</code> に配置します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp:Assets/Scripts/KeychainService.cs data-lang=csharp:Assets/Scripts/KeychainService.cs><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Runtime.InteropServices;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>///     実装は &lt;c&gt;Assets/Plugins/iOS/KeychainService.mm&lt;/c&gt; に記載</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>///     &lt;a href=&#34;https://developer.apple.com/documentation/security/keychain_services&#34;&gt;Keychain Services&lt;/a&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>KeychainService</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span><span style=color:#75715e>#if</span> UNITY_IOS
</span></span><span style=display:flex><span><span style=color:#a6e22e>    [DllImport(&#34;__Internal&#34;)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>extern</span> <span style=color:#66d9ef>int</span> addItem(<span style=color:#66d9ef>string</span> dataType, <span style=color:#66d9ef>string</span> <span style=color:#66d9ef>value</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>    [DllImport(&#34;__Internal&#34;)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>extern</span> <span style=color:#66d9ef>string</span> getItem(<span style=color:#66d9ef>string</span> dataType);
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>    [DllImport(&#34;__Internal&#34;)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>extern</span> <span style=color:#66d9ef>int</span> deleteItem(<span style=color:#66d9ef>string</span> dataType);
</span></span><span style=display:flex><span><span style=color:#75715e>#endif</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> Put(<span style=color:#66d9ef>string</span> key, <span style=color:#66d9ef>string</span> <span style=color:#66d9ef>value</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span><span style=color:#75715e>#if</span> UNITY_IOS
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 返却されるステータスが 0 なら成功</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> addItem(key, <span style=color:#66d9ef>value</span>) == <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Get(<span style=color:#66d9ef>string</span> key)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span><span style=color:#75715e>#if</span> UNITY_IOS
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> getItem(key);
</span></span><span style=display:flex><span><span style=color:#75715e>#else</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> Delete(<span style=color:#66d9ef>string</span> key)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span><span style=color:#75715e>#if</span> UNITY_IOS
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 返却されるステータスが 0 なら成功</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> deleteItem(key) == <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>あとは用途に応じて下記のようなコードで設定値の保存や取得などを行えます。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// ...</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> _keychainService = <span style=color:#66d9ef>new</span> KeychainService();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// name をキーとして値を nikaera で保存する</span>
</span></span><span style=display:flex><span>_keychainService.Put(<span style=color:#e6db74>&#34;name&#34;</span>, <span style=color:#e6db74>&#34;nikaera&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// name をキーとして値を取得する</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> name = _keychainService.Get(<span style=color:#e6db74>&#34;name&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// &#34;nikaera&#34; が出力される</span>
</span></span><span style=display:flex><span>Debug.Log(name);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//　name をキーとして値を削除する</span>
</span></span><span style=display:flex><span>_keychainService.Delete(<span style=color:#e6db74>&#34;name&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ...</span>
</span></span></code></pre></div><h1 id=余談-インターフェースで-iosandroid-のふるまいを共通化する>(余談) インターフェースで iOS/Android のふるまいを共通化する<a hidden class=anchor aria-hidden=true href=#余談-インターフェースで-iosandroid-のふるまいを共通化する>#</a></h1><p>このままだとプラットフォームを切り替える毎にコードを書き直さないとならないので、インターフェースを利用して共通化を行います。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp:Assets/Scripts/ISecretManager.cs data-lang=csharp:Assets/Scripts/ISecretManager.cs><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ISecretManager</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// 指定したキーで値を保存する関数</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;param name=&#34;key&#34;&gt;キー&lt;/param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;param name=&#34;value&#34;&gt;値&lt;/param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;returns&gt;保存に成功したかどうか&lt;/returns&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>bool</span> Put(<span style=color:#66d9ef>string</span> key, <span style=color:#66d9ef>string</span> <span style=color:#66d9ef>value</span>); 
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// 指定したキーの値を取得する関数</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;param name=&#34;key&#34;&gt;キー&lt;/param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;returns&gt;指定したキーで設定された値、無ければ null&lt;/returns&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>string</span> Get(<span style=color:#66d9ef>string</span> key);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// 指定したキーの値を削除する関数</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;param name=&#34;key&#34;&gt;キー&lt;/param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;returns&gt;削除に成功したかどうか&lt;/returns&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>bool</span> Delete(<span style=color:#66d9ef>string</span> key);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>その後、<code>Assets/Scripts/EncryptedSharedPreferences.cs</code> および <code>Assets/Scripts/KeychainService.cs</code> を下記の通り <code>ISecretManager</code> の実装に紐付けます。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp:Assets/Scripts/EncryptedSharedPreferences.cs data-lang=csharp:Assets/Scripts/EncryptedSharedPreferences.cs><span style=display:flex><span><span style=color:#66d9ef>using</span> UnityEngine;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>///     利用するネイティブコードは &lt;c&gt;Assets/Plugins/Android/SecretManager.java&lt;/c&gt; に記載</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>///     &lt;a href=&#34;https://developer.android.com/reference/androidx/security/crypto/EncryptedSharedPreferences&#34;&gt;EncryptedSharedPreferences&lt;/a&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>EncryptedSharedPreferences</span>: ISecretManager
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> AndroidJavaObject _secretManager;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> EncryptedSharedPreferences()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> activity = <span style=color:#66d9ef>new</span> AndroidJavaClass(<span style=color:#e6db74>&#34;com.unity3d.player.UnityPlayer&#34;</span>)
</span></span><span style=display:flex><span>            .GetStatic&lt;AndroidJavaObject&gt;(<span style=color:#e6db74>&#34;currentActivity&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> context = activity.Call&lt;AndroidJavaObject&gt;(<span style=color:#e6db74>&#34;getApplicationContext&#34;</span>);
</span></span><span style=display:flex><span>        _secretManager = <span style=color:#66d9ef>new</span> AndroidJavaObject(<span style=color:#e6db74>&#34;com.nikaera.SecretManager&#34;</span>, context);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#region</span> ISecretManager
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> Put(<span style=color:#66d9ef>string</span> key, <span style=color:#66d9ef>string</span> <span style=color:#66d9ef>value</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> _secretManager.Call&lt;<span style=color:#66d9ef>bool</span>&gt;(<span style=color:#e6db74>&#34;put&#34;</span>, key, <span style=color:#66d9ef>value</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Get(<span style=color:#66d9ef>string</span> key)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> _secretManager.Call&lt;<span style=color:#66d9ef>string</span>&gt;(<span style=color:#e6db74>&#34;get&#34;</span>, key);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> Delete(<span style=color:#66d9ef>string</span> key)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> _secretManager.Call&lt;<span style=color:#66d9ef>bool</span>&gt;(<span style=color:#e6db74>&#34;delete&#34;</span>, key);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#endregion</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp:Assets/Scripts/KeychainService.cs data-lang=csharp:Assets/Scripts/KeychainService.cs><span style=display:flex><span><span style=color:#66d9ef>using</span> System.Runtime.InteropServices;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>///     実装は &lt;c&gt;Assets/Plugins/iOS/KeychainService.mm&lt;/c&gt; に記載</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>///     &lt;a href=&#34;https://developer.apple.com/documentation/security/keychain_services&#34;&gt;Keychain Services&lt;/a&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>KeychainService</span>: ISecretManager
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span><span style=color:#75715e>#if</span> UNITY_IOS
</span></span><span style=display:flex><span><span style=color:#a6e22e>    [DllImport(&#34;__Internal&#34;)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>extern</span> <span style=color:#66d9ef>int</span> addItem(<span style=color:#66d9ef>string</span> dataType, <span style=color:#66d9ef>string</span> <span style=color:#66d9ef>value</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>    [DllImport(&#34;__Internal&#34;)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>extern</span> <span style=color:#66d9ef>string</span> getItem(<span style=color:#66d9ef>string</span> dataType);
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>    [DllImport(&#34;__Internal&#34;)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>extern</span> <span style=color:#66d9ef>int</span> deleteItem(<span style=color:#66d9ef>string</span> dataType);
</span></span><span style=display:flex><span><span style=color:#75715e>#endif</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// KeychainService.mm に定義した関数を呼び出す</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#region</span> ISecretManager
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> Put(<span style=color:#66d9ef>string</span> key, <span style=color:#66d9ef>string</span> <span style=color:#66d9ef>value</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span><span style=color:#75715e>#if</span> UNITY_IOS
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> addItem(key, <span style=color:#66d9ef>value</span>) == <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#else</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Get(<span style=color:#66d9ef>string</span> key)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span><span style=color:#75715e>#if</span> UNITY_IOS
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> getItem(key);
</span></span><span style=display:flex><span><span style=color:#75715e>#else</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> Delete(<span style=color:#66d9ef>string</span> key)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span><span style=color:#75715e>#if</span> UNITY_IOS
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> deleteItem(key) == <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#else</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#endregion</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>あとは上記をよしなに利用可能な <code>SecretManager</code> クラスを作成します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp:Assets/Scripts/SecretManager.cs data-lang=csharp:Assets/Scripts/SecretManager.cs><span style=display:flex><span><span style=color:#66d9ef>using</span> UnityEngine;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>///     &lt;em&gt;Editor 利用時のみ PlayerPrefs を利用する&lt;/em&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;&lt;see cref=&#34;KeychainService&#34; /&gt;, &lt;see cref=&#34;EncryptedSharedPreferences&#34; /&gt;&lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SecretManager</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span><span style=color:#75715e>#if</span> UNITY_EDITOR
</span></span><span style=display:flex><span><span style=color:#75715e>#elif</span> UNITY_ANDROID
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> ISecretManager _instance = <span style=color:#66d9ef>new</span> EncryptedSharedPreferences();
</span></span><span style=display:flex><span><span style=color:#75715e>#elif</span> UNITY_IOS
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> ISecretManager _instance = <span style=color:#66d9ef>new</span> KeychainService();
</span></span><span style=display:flex><span><span style=color:#75715e>#endif</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>bool</span> Put(<span style=color:#66d9ef>string</span> key, <span style=color:#66d9ef>string</span> <span style=color:#66d9ef>value</span>)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span><span style=color:#75715e>#if</span> UNITY_EDITOR
</span></span><span style=display:flex><span>                PlayerPrefs.SetString(key, <span style=color:#66d9ef>value</span>);
</span></span><span style=display:flex><span>                PlayerPrefs.Save();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#elif</span> UNITY_IOS || UNITY_ANDROID
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> _instance.Put(key, <span style=color:#66d9ef>value</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>#else</span>
</span></span><span style=display:flex><span>                Debug.Log(<span style=color:#e6db74>&#34;Not Implemented.&#34;</span>);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>string</span> Get(<span style=color:#66d9ef>string</span> key)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span><span style=color:#75715e>#if</span> UNITY_EDITOR
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> PlayerPrefs.GetString(key);
</span></span><span style=display:flex><span><span style=color:#75715e>#elif</span> UNITY_IOS || UNITY_ANDROID
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> _instance.Get(key);
</span></span><span style=display:flex><span><span style=color:#75715e>#else</span>
</span></span><span style=display:flex><span>            Debug.Log(<span style=color:#e6db74>&#34;Not Implemented.&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>bool</span> Delete(<span style=color:#66d9ef>string</span> key)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span><span style=color:#75715e>#if</span> UNITY_EDITOR
</span></span><span style=display:flex><span>            PlayerPrefs.DeleteKey(key);
</span></span><span style=display:flex><span>            PlayerPrefs.Save();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#elif</span> UNITY_IOS || UNITY_ANDROID
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> _instance.Delete(key);
</span></span><span style=display:flex><span><span style=color:#75715e>#else</span>
</span></span><span style=display:flex><span>            Debug.Log(<span style=color:#e6db74>&#34;Not Implemented.&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>#endif</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>これでプラットフォーム間の実装差異を気にすることなく、下記のような記述で設定値の保存や取得などを行えます。<strong>iOS/Android 以外のプラットフォームで追加実装したい場合は <a href=https://docs.unity3d.com/ja/2021.1/Manual/PlatformDependentCompilation.html>プラットフォーム依存コンパイル</a> と <code>ISecretManager</code> の実装クラスを新たに作成することで簡単に追加できます。</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// ...</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// name をキーとして値を nikaera で保存する</span>
</span></span><span style=display:flex><span>SecretManager.Put(<span style=color:#e6db74>&#34;name&#34;</span>, <span style=color:#e6db74>&#34;nikaera&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// name をキーとして値を取得する</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> name = SecretManager.Get(<span style=color:#e6db74>&#34;name&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// &#34;nikaera&#34; が出力される</span>
</span></span><span style=display:flex><span>Debug.Log(name);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//　name をキーとして値を削除する</span>
</span></span><span style=display:flex><span>SecretManager.Delete(<span style=color:#e6db74>&#34;name&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ...</span>
</span></span></code></pre></div><h1 id=おわりに>おわりに<a hidden class=anchor aria-hidden=true href=#おわりに>#</a></h1><p>今回は iOS/Android で設定値をセキュアに扱うための方法についてまとめてみました。実際は <code>Keychain Services</code> 周りは実装が大変なので、<code>External Dependency Manager for Unity</code> とか使って <a href=https://github.com/kishikawakatsumi/KeychainAccess>KeychainAccess</a> のような外部ライブラリを利用する構成のほうが良いと思われます。</p><p>本記事の内容に誤りがあったり、実際にはセキュアな実装ができていない等々あれば是非コメントでご指摘いただけますと幸いです。</p><h1 id=参考リンク>参考リンク<a hidden class=anchor aria-hidden=true href=#参考リンク>#</a></h1><ul><li><a href="https://developer.android.com/topic/security/data?hl=ja">Android デベロッパー  |  Android Developers</a></li><li><a href="https://developer.android.com/reference/androidx/security/crypto/EncryptedSharedPreferences?hl=ja">EncryptedSharedPreferences  |  Android デベロッパー  |  Android Developers</a></li><li><a href=https://developer.apple.com/documentation/security/keychain_services>Keychain Services | Apple Developer Documentation</a></li><li><a href=https://qiita.com/masaki_shoji/items/6c512c7ebb30a13cda1d>SharedPreferences を自前で難読化するのはもう古い?これからは EncryptedSharedPrefenreces を使おう - Qiita</a></li><li><a href=https://qiita.com/sachiko-kame/items/261d42c57207e4b7002a>iOS のキーチェーンについて - Qiita</a></li><li><a href=https://qiita.com/nyhk-oi/items/189236d0627d43e7d658>Unity で IOS にセキュアに値を保存するには KeyChain を使おう - Qiita</a></li><li><a href=https://github.com/googlesamples/unity-jar-resolver>googlesamples/unity-jar-resolver: Unity plugin which resolves Android & iOS dependencies and performs version management</a></li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>逆に <code>External Dependency Manager for Unity</code> を利用する方法のメリットは、UnityPackage などでライブラリとして配布する際に、ライブラリを動作させるのに必要な外部パッケージも同梱した状態で配布が可能になるなどがあります。(当然ライセンスには気を付ける必要がありますが&mldr;)&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>パッケージの依存関係を自動で解決するかどうかという選択肢になります。本記事では明示的に Resolve を実行するため <code>Disable</code> でも <code>Enable</code> でも進行上の問題はありません。&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://cocoapods.org/>CocoaPods</a> もサポートされているようなので、iOS でも Android 同様、外部ライブラリを取り込むのは簡単にできそうでした。例えば <a href=https://github.com/kishikawakatsumi/KeychainAccess>KeychainAccess</a> とか使いたい。&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://nikaera.com/tags/unity/>Unity</a></li><li><a href=https://nikaera.com/tags/ios/>Ios</a></li><li><a href=https://nikaera.com/tags/android/>Android</a></li></ul><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 📔 Unity で iOS/Android アプリの設定値をセキュアに扱う方法 on x" href="https://x.com/intent/tweet/?text=%f0%9f%93%94%20Unity%20%e3%81%a7%20iOS%2fAndroid%20%e3%82%a2%e3%83%97%e3%83%aa%e3%81%ae%e8%a8%ad%e5%ae%9a%e5%80%a4%e3%82%92%e3%82%bb%e3%82%ad%e3%83%a5%e3%82%a2%e3%81%ab%e6%89%b1%e3%81%86%e6%96%b9%e6%b3%95&amp;url=https%3a%2f%2fnikaera.com%2farchives%2funity-ios-android-secret-manager%2f&amp;hashtags=unity%2cios%2candroid"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 📔 Unity で iOS/Android アプリの設定値をセキュアに扱う方法 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fnikaera.com%2farchives%2funity-ios-android-secret-manager%2f&amp;title=%f0%9f%93%94%20Unity%20%e3%81%a7%20iOS%2fAndroid%20%e3%82%a2%e3%83%97%e3%83%aa%e3%81%ae%e8%a8%ad%e5%ae%9a%e5%80%a4%e3%82%92%e3%82%bb%e3%82%ad%e3%83%a5%e3%82%a2%e3%81%ab%e6%89%b1%e3%81%86%e6%96%b9%e6%b3%95&amp;summary=%f0%9f%93%94%20Unity%20%e3%81%a7%20iOS%2fAndroid%20%e3%82%a2%e3%83%97%e3%83%aa%e3%81%ae%e8%a8%ad%e5%ae%9a%e5%80%a4%e3%82%92%e3%82%bb%e3%82%ad%e3%83%a5%e3%82%a2%e3%81%ab%e6%89%b1%e3%81%86%e6%96%b9%e6%b3%95&amp;source=https%3a%2f%2fnikaera.com%2farchives%2funity-ios-android-secret-manager%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 📔 Unity で iOS/Android アプリの設定値をセキュアに扱う方法 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fnikaera.com%2farchives%2funity-ios-android-secret-manager%2f&title=%f0%9f%93%94%20Unity%20%e3%81%a7%20iOS%2fAndroid%20%e3%82%a2%e3%83%97%e3%83%aa%e3%81%ae%e8%a8%ad%e5%ae%9a%e5%80%a4%e3%82%92%e3%82%bb%e3%82%ad%e3%83%a5%e3%82%a2%e3%81%ab%e6%89%b1%e3%81%86%e6%96%b9%e6%b3%95"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 📔 Unity で iOS/Android アプリの設定値をセキュアに扱う方法 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fnikaera.com%2farchives%2funity-ios-android-secret-manager%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 📔 Unity で iOS/Android アプリの設定値をセキュアに扱う方法 on whatsapp" href="https://api.whatsapp.com/send?text=%f0%9f%93%94%20Unity%20%e3%81%a7%20iOS%2fAndroid%20%e3%82%a2%e3%83%97%e3%83%aa%e3%81%ae%e8%a8%ad%e5%ae%9a%e5%80%a4%e3%82%92%e3%82%bb%e3%82%ad%e3%83%a5%e3%82%a2%e3%81%ab%e6%89%b1%e3%81%86%e6%96%b9%e6%b3%95%20-%20https%3a%2f%2fnikaera.com%2farchives%2funity-ios-android-secret-manager%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 📔 Unity で iOS/Android アプリの設定値をセキュアに扱う方法 on telegram" href="https://telegram.me/share/url?text=%f0%9f%93%94%20Unity%20%e3%81%a7%20iOS%2fAndroid%20%e3%82%a2%e3%83%97%e3%83%aa%e3%81%ae%e8%a8%ad%e5%ae%9a%e5%80%a4%e3%82%92%e3%82%bb%e3%82%ad%e3%83%a5%e3%82%a2%e3%81%ab%e6%89%b1%e3%81%86%e6%96%b9%e6%b3%95&amp;url=https%3a%2f%2fnikaera.com%2farchives%2funity-ios-android-secret-manager%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 📔 Unity で iOS/Android アプリの設定値をセキュアに扱う方法 on ycombinator" href="https://news.ycombinator.com/submitlink?t=%f0%9f%93%94%20Unity%20%e3%81%a7%20iOS%2fAndroid%20%e3%82%a2%e3%83%97%e3%83%aa%e3%81%ae%e8%a8%ad%e5%ae%9a%e5%80%a4%e3%82%92%e3%82%bb%e3%82%ad%e3%83%a5%e3%82%a2%e3%81%ab%e6%89%b1%e3%81%86%e6%96%b9%e6%b3%95&u=https%3a%2f%2fnikaera.com%2farchives%2funity-ios-android-secret-manager%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://nikaera.com/>Nikaeraintokyo.</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>